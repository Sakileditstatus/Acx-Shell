services:
  - type: web
    name: acx-shell
    env: python
    plan: free  # Free tier - 512MB RAM, 750 hours/month, 1GB disk
    region: oregon  # Free tier regions: oregon, frankfurt, singapore
    buildCommand: |
      echo "üöÄ Building Acx Shell for Render Free Tier..."
      echo "üì¶ Installing Java JDK 21..."
      sudo apt-get update -qq
      sudo apt-get install -y -qq wget apt-transport-https gnupg
      wget -qO - https://packages.adoptium.net/artifactory/api/gpg/key/public | sudo apt-key add - > /dev/null 2>&1
      echo "deb https://packages.adoptium.net/artifactory/deb $(awk -F= '/^VERSION_CODENAME/{print $2}' /etc/os-release) main" | sudo tee /etc/apt/sources.list.d/adoptium.list > /dev/null
      sudo apt-get update -qq
      sudo apt-get install -y -qq temurin-21-jdk
      export JAVA_HOME=/usr/lib/jvm/temurin-21-jdk-amd64
      export PATH=$JAVA_HOME/bin:$PATH
      echo "‚úÖ Java installed:"
      java -version
      echo "üì¶ Installing Python dependencies..."
      pip install --no-cache-dir -r requirements.txt
      echo "‚úÖ Build completed!"
    startCommand: |
      export JAVA_HOME=/usr/lib/jvm/temurin-21-jdk-amd64
      export PATH=$JAVA_HOME/bin:$PATH
      echo "üöÄ Starting Acx Shell..."
      echo "üìç Server running on port: $PORT"
      python app.py
    envVars:
      - key: PORT
        value: 5000
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: JAVA_HOME
        value: /usr/lib/jvm/temurin-21-jdk-amd64
      - key: FLASK_ENV
        value: production
    healthCheckPath: /health